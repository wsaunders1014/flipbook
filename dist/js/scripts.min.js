var pages=$(".page").length;console.log(pages);var currPage=0,w=window.innerWidth,h=window.innerHeight,pagesShown=w<=h?1:2;$(document).ready(function(){$(".arrow").click(function(){console.log("arrow click");var e=$(".page").width(),t=$(".page").height();console.log(e,t),$(this).hasClass("left")&&0!=currPage?($(".page").eq(currPage-2).css({zIndex:4,clip:"rect(0px,"+e+"px,"+t+"px, 0px)"}).find("img").css({left:0}),$(".page").eq(currPage-1).addClass("opening").css({zIndex:5,textIndent:0}).animate({textIndent:100},{ease:"easeInOut",duration:1e3,step:function(s){console.log(s),$(this).find("img").css({left:s+"%"}),$(this).css({left:s/2+"%"}),$(this).next().css({clip:"rect(0px,"+e+"px,"+t+"px,"+e*(s/100)+"px)"})}}),currPage-=pagesShown):$(this).hasClass("right")&&currPage<pages-pagesShown?($(".page").eq(currPage+2).css({zIndex:4,clip:"rect(0px,"+e+"px,"+t+"px, "+e+"px)"}).find("img").css({left:0}),$(".page").eq(currPage+1).css({zIndex:5,textIndent:100}).animate({textIndent:0},{ease:"easeInOut",duration:1e3,step:function(s){$(this).find("img").css({left:s+"%"}),$(this).css({left:s/2+"%"}),$(this).next().css({clip:"rect(0px,"+e+"px,"+t+"px,"+e*(s/100)+"px)"})}}),currPage+=pagesShown):$(this).hasClass("right")&&($(".page").eq(currPage+1).addClass("opening").css({zIndex:5,textIndent:100}).animate({textIndent:0},{ease:"easeInOut",duration:1e3,step:function(e){$(this).find("img").css({left:e+"%"}),$(".page").css({left:e/2+"%"}),$(this).css({left:e/2+"%"})}}),currPage=pages)}),$(".page").dblclick(function(){$(this).toggleClass("zoom"),$(".arrow").toggleClass("hide"),$(this).find("img").css({left:0,top:0})}),$("#page-holder").on("mousedown",".zoom",function(e){var t=$(this),s=t.find("img"),n=s[0].getBoundingClientRect().width,i=s[0].getBoundingClientRect().height,o=t.width(),a=t.height(),g=s.offset().left,c=s.offset().top,p=(s.position().left,s.position().top,t.offset().left),l=t.offset().top,r=e.pageX,f=e.pageY,h=i-a-l,d=n-o-p;$(this).on("mousemove",function(e){var t=g+(e.pageX-r),s=c+(e.pageY-f);console.log(t,p),t>p&&(t=p),t<-d&&(t=-d),s>l&&(s=l),s<-h&&(s=-h),$(this).find("img").offset({left:t,top:s})}).on("mouseup mouseleave",function(){$(this).off("mousemove mouseup mouseleave")})})});